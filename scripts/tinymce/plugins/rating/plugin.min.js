tinymce.PluginManager.add("rating",function(e,n){let t=n=>{if(!e.selection.isCollapsed())return;if(!n||!n.element)return;let t;if(n&&n.element&&(n.element.dataset&&"rating-system-tinymce"==n.element.className&&(t=n.element),"SPAN"==n.element.nodeName&&n.element.parentElement&&"rating-system-tinymce"==n.element.parentElement.className&&(t=n.element.parentElement)),t)if(t.nextElementSibling)e.selection.select(t.nextElementSibling,!0),e.selection.collapse(!0);else{let n=e.dom.create("p");e.dom.insertAfter(n,t),e.selection.select(n,!0),e.selection.collapse(!0)}};return e.on("NodeChange",t),e.on("click",t),e.addButton("rating",{text:"Rating",icon:!1,onclick:function(){e.windowManager.open({title:"Add new rating",url:n+"/dialog.html",width:400,height:100,buttons:[{text:"Add",classes:"widget btn primary",onclick:function(){const n=e.windowManager.getWindows()[0];let t=(i="data_id",n.getContentWindow().document.getElementById(i)).value.trim();var i;t=escape(t),e.insertContent(`<img src="trigger_errorasd" onerror="typeof buildfire !== 'undefined' && buildfire.ratingSystem.inject()" style="display: none">\n                                    <div class="rating-system-tinymce" data-rating-id="${t}" style="text-align: center;" data-mce-style="text-align: center;">\n                                    <span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span>\n                                </div><br>`),n.close()}},{text:"Cancel",onclick:function(){e.windowManager.getWindows()[0].close()}}]})}}),{getMetadata:function(){return{name:"Rating Plugin"}}}});