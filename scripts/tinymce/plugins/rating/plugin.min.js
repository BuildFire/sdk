tinymce.PluginManager.add("rating",function(e,t){return e.on("keydown",function(t){if(13==t.keyCode){let n,i=tinymce.activeEditor.selection.getNode();if(i.dataset&&"rating-system-tinymce"==i.className?n=i:"SPAN"==i.nodeName&&i.parentElement&&"rating-system-tinymce"==i.parentElement.className&&(n=i.parentElement),n){t.preventDefault();let i=e.dom.create("br");e.dom.insertAfter(i,n);let a=e.dom.create("p");e.dom.insertAfter(a,n),e.selection.select(a,!0),e.selection.collapse(!0)}}}),e.addButton("rating",{text:"Rating",icon:!1,onclick:function(){e.windowManager.open({title:"Add new rating",url:t+"/dialog.html",width:400,height:100,buttons:[{text:"Add",classes:"widget btn primary",onclick:function(){const t=e.windowManager.getWindows()[0];let n=(i="data_id",t.getContentWindow().document.getElementById(i)).value.trim();var i;n=escape(n),e.insertContent(`<img src="trigger_errorasd" onerror="typeof buildfire !== 'undefined' && buildfire.ratingSystem.inject()" style="display: none">\n                                  <div class="rating-system-tinymce" data-rating-id="${n}" style="text-align: center;" data-mce-style="text-align: center;">\n                                      &#9733;&#9733;&#9733;&#9733;&#9733;\n                                  </div><br>`),t.close()}},{text:"Cancel",onclick:function(){e.windowManager.getWindows()[0].close()}}]})}}),{getMetadata:function(){return{name:"Rating Plugin"}}}});