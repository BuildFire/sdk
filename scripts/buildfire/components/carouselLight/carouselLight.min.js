"use strict";if("undefined"==typeof buildfire)throw"please add buildfire.js first to use carousel components";void 0===buildfire.components&&(buildfire.components={}),void 0===buildfire.components.carousel&&(buildfire.components.carousel={}),function(){"undefined"==typeof lory&&document.write('<script src="../../../scripts/lory/lory.min.js"><\/script>');var e=document.getElementById("loryInjectedStyle");e&&document.head.removeChild(e),(e=document.createElement("style")).id="loryInjectedStyle",e.innerHTML+=" .loryFrame {position: relative;font-size: 0; line-height: 0; overflow: hidden; white-space: nowrap;}",e.innerHTML+=" .loryFrame li { position: relative; display: inline-block; height: 100%;}",e.innerHTML+=" .lorySlides { display: inline-block;}",e.innerHTML+=" .loryPercentage .lorySlides { display: block; padding: 0px;}",e.innerHTML+=" .loryPercentage li { width: 100%;}",e.innerHTML+=" .blurred-background-image { filter: blur(30px); position: absolute; top: 0 }",e.innerHTML+=" .js_slide { text-align: center; position: relative; max-height: 380px; }",e.innerHTML+=" .js_slide img { max-height: 380px; width: auto !important; margin: 0 auto }",e.innerHTML+=" .js_slide.static_slide { display: none }",e.innerHTML+=" .js_slide.static_slide.active { display: block }",document.head.appendChild(e)}(),buildfire.components.carousel.view=function(t){let s=this;this.config=this.mergeSettings(t),this._initDimensions(s.config.layout),this.selector="string"==typeof this.config.selector?document.querySelector(this.config.selector):this.config.selector,this._attachEventListeners(),t.items&&0<t.items.length?(this._applyConfigurations(t,(e,i)=>{1<t.items.length&&i.shouldInitializeLory?s.init():s._renderStaticSlides(t.items)}),t.selector?t.selector.style.display="":console.error("Selector element should be provided")):t.selector?t.selector.style.display="none":console.error("Selector element should be provided")},buildfire.components.carousel.view.lastCarouselTimer=null,buildfire.components.carousel.view.prototype={lastImage:null,_applyConfigurations:function(e,r){let o=this,{items:a,autoInterval:c,order:i,display:t}=e;buildfire.components.carousel.view.lastCarouselTimer&&(clearInterval(buildfire.components.carousel.view.lastCarouselTimer),buildfire.components.carousel.view.lastCarouselTimer=null);let d="LAUNCHER_PLUGIN"==buildfire.getFrameType()?"carouselLastImageHome":"carouselLastImage";0==i&&1==t&&1<a.length?buildfire.localStorage.getItem(d,function(e,i){let t=a,s=0,l=null;var n;null==i||-1==(n=Number(i))||n==a.length-1?l=a[0]:(l=a[n+1],s=n+1),o.lastImage=l,buildfire.localStorage.setItem(d,s,function(e,i){0!=c&&(buildfire.components.carousel.view.lastCarouselTimer=setInterval(o._changeImage.bind(o),o.config.autoInterval,t,!1))}),r(null,{shouldInitializeLory:!1})}):1==i&&1==t&&1<a.length?(0!=c&&(buildfire.components.carousel.view.lastCarouselTimer=setInterval(this._changeImage.bind(this),this.config.autoInterval,a,!0)),item=a[Math.floor(Math.random()*a.length)],this.lastImage=item,buildfire.localStorage.removeItem(d),r(null,{shouldInitializeLory:!1})):(1==i&&0==t&&1<a.length&&(this._randomizeArray(a),buildfire.localStorage.removeItem(d)),r(null,{shouldInitializeLory:!0}))},_randomizeArray:function(e){this._shuffle(e,null,null);var i=Array.from(e);this._shuffle(i,null,e[e.length-1]),e.push(...i),this._shuffle(i,e[0],e[e.length-1]),e.push(...i)},_shuffle:function(e,i,t){let s,l,n;for(n=e.length-1;0<n;n--)s=Math.floor(Math.random()*(n+1)),l=e[n],e[n]=e[s],e[s]=l;return t==e[0]||i==e[e.length-1]?this._shuffle(e,i,t):e},_changeImage:function(t,i){let s=this,l=null;if(i)this._changeStaticSlides(t,!0);else{i=t.indexOf(this.lastImage);let e=0;-1==i||i==t.length-1?l=t[0]:(l=t[i+1],e=i+1),this.lastImage=l;i="LAUNCHER_PLUGIN"==buildfire.getFrameType();buildfire.localStorage.setItem(i?"carouselLastImageHome":"carouselLastImage",e,function(e,i){s._changeStaticSlides(t)})}},_changeStaticSlides:function(i,e){let t=document.querySelector(".js_slide.static_slide.active"),s=t.nextSibling;if(e){let e=document.querySelectorAll(".js_slide.static_slide")[Math.floor(Math.random()*i.length)];e.children[0].src==t.children[0].src?this._changeStaticSlides(i,!0):(t.classList.remove("active"),e.classList.add("active"))}else t.classList.remove("active"),(s||document.querySelector(".js_slide.static_slide")).classList.add("active")},_renderStaticSlides:function(e){let s=this;this.selector.innerHTML="",e.forEach((e,i)=>{let t=document.createElement("div");t.classList.add("js_slide","static_slide"),(0==i&&!s.lastImage||s.lastImage&&s.lastImage.iconUrl==e.iconUrl)&&t.classList.add("active"),t.addEventListener("click",function(){buildfire.actionItems.execute(e,function(e,i){e&&console.warn("Error opening slider action: ",e)})});i={item:e,slide:t};s._cropImage(i,(e,i)=>{e&&console.error("Error occurred while cropping image: ",e),s.selector.appendChild(t)})}),document.querySelector(".js_slide.static_slide.active")||document.querySelector(".js_slide.static_slide").classList.add("active")},mergeSettings:function(e){var i,t={selector:".js_percentage",items:[],layout:null,speed:200,loop:!0,autoInterval:5e3,display:0,order:0},s=e;for(i in s)t[i]=s[i];return t},init:function(){if(!this.selector)throw"selector not found";this.selector.style["min-height"]=this._minHeight;var t=this;function e(){buildfire.getContext(function(e,i){i&&i.device&&i.device.platform&&"ios"==i.device.platform.toLowerCase()&&"LAUNCHER_PLUGIN"==buildfire.getFrameType()&&(buildfire.navigation.onAppLauncherActive(function(){t._applySlider()},!0),buildfire.navigation.onAppLauncherInactive(function(){t._destroySlider()},!0))})}this.config.items&&0<this.config.items.length?this._renderHTMLItems(function(){t._applySlider(),e()}):(t._applySlider(),e())},_destroySlider:function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},_applySlider:function(){var e;this.lorySlider||(this.lorySlider=lory(this.config.selector,{classNameSlideContainer:this.config.classNameSlideContainer||"js_slides",classNameFrame:this.config.classNameFrame||"js_frame",ease:"ease",rewindSpeed:600,slideSpeed:this.config.speed,slidesToScroll:this.config.slidesToScroll||1,infinite:this.config.infinite||1,enableMouseEvents:!0})),this.config.loop&&this.config.items&&1<this.config.items.length&&((e=this).timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null),this.timerInterval=setInterval(function(){e.lorySlider.next()},this.config.autoInterval))},_renderHTMLItems:function(e){for(var i=this;this.selector.firstChild;)this.selector.removeChild(this.selector.firstChild);this.sliderFrame=document.createElement("div"),["loryFrame","js_frame"].forEach(function(e){i.sliderFrame.classList.add(e)}),this.slideContainer=document.createElement("ul"),["lorySlides","js_slides"].forEach(function(e){i.slideContainer.classList.add(e)}),this._loadImages(this.config.items,function(){["slider","js_percentage","loryPercentage"].forEach(function(e){i.selector.classList.add(e)}),i.sliderFrame.appendChild(i.slideContainer),i.selector.appendChild(i.sliderFrame),e()})},_loadImages:function(e,i){var t=this,s=e.length,l=s;0==s&&i();for(var n=0;n<s;n++)this._appendItem(e[n],function(e){l--,t.slideContainer.appendChild(e),0==l&&i()})},_appendItem:function(e,t){let i=this,s=document.createElement("li");s.classList.add("js_slide"),s.addEventListener("click",function(){i.preventClicks||buildfire.actionItems.execute(e,function(e,i){e&&console.warn("Error opening slider action: ",e)})});var l={item:e,slide:s};this._cropImage(l,(e,i)=>{e&&console.error("Error occurred while cropping image: ",e),t(s)})},append:function(e){if((e=e&&(e instanceof Array||"object"!=typeof e?e:[e]))&&e instanceof Array&&e.length){for(var i=0;i<e.length;i++)this.config.items.push(e[i]);var t=this;0==this.config.display&&1<this.config.items.length?(t.slideContainer.innerHTML="",this._loadImages(this.config.items,function(){t.lorySlider.setup()})):this._renderStaticSlides(this.config.items)}},loadItems:function(i,e){if(e)this.append(i);else{let e=this;this.config.items=i,0==this.config.display&&1<i.length?(1==this.config.order&&this._randomizeArray(i),this.slideContainer.innerHTML="",this._loadImages(i,function(){e.lorySlider.setup()})):(buildfire.components.carousel.view.lastCarouselTimer&&(clearInterval(buildfire.components.carousel.view.lastCarouselTimer),buildfire.components.carousel.view.lastCarouselTimer=null),this._renderStaticSlides(i),buildfire.components.carousel.view.lastCarouselTimer=setInterval(this._changeImage.bind(this),this.config.autoInterval,i,this.config.order))}},_initDimensions:function(e){this.width=window.innerWidth,"WideScreen"==(e=e||"WideScreen")?(this.height=Math.ceil(9*this.width/16),this.aspect="16:9"):"Square"==e?(this.height=this.width,this.aspect="1:1"):"Cinema"==e?(this.height=Math.ceil(+this.width/2.39),this.aspect="2.39:1"):"MobileScreen"==e&&(this.height=window.innerHeight/this.width*this.width,this.aspect="9:16"),this.cssWidth=this.width+"px",380<this.height?this.cssHeight="380px":this.cssHeight=this.height+"px",this._minHeight=this.cssHeight},_cropImage:function(e,s){let l=this,{item:n,slide:r}=e;buildfire.imageLib.local.cropImage(n.iconUrl,{width:this.width,height:this.height,aspect:this.aspect,size:"full_width"},function(e,t){if(e)s(e,null);else{let e=document.createElement("img"),i=document.createElement("img");e.src=i.src=t,e.alt=i.alt=n.title||"",i.className="blurred-background-image",i.setAttribute("style","width: 100% !important; transform: scale(1.2) !important;"),r.style.overflow="hidden",e.style.transform="translateZ(0)",380<l.height&&r.appendChild(i),r.appendChild(e),s(null,t)}})},_attachEventListeners:function(){let e=this;this.selector.addEventListener("on.lory.touchmove",function(){e.preventClicks||(e.preventClicks=!0)}),this.selector.addEventListener("on.lory.touchend",function(){setTimeout(()=>{e.preventClicks=!1},0)})}};
//# sourceMappingURL=carouselLight.min.js.map
