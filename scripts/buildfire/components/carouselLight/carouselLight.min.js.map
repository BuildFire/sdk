{"version":3,"sources":["../sdk/scripts/buildfire/components/carouselLight/carouselLight.js"],"names":["buildfire","components","carousel","scripts","document","getElementsByTagName","carouselScriptSrc","i","length","src","toLowerCase","indexOf","lory","write","style","getElementById","head","removeChild","createElement","id","innerHTML","appendChild","view","options","items","this","config","mergeSettings","_initDimensions","layout","init","selector","img","setAttribute","imageLib","cropImage","iconUrl","size","aspect","width","window","innerWidth","height","Math","ceil","alt","addEventListener","actionItems","execute","err","result","console","warn","display","prototype","settings","speed","loop","autoInterval","userSttings","attrname","querySelector","self","validateLauncherCarousel","getContext","device","platform","getFrameType","navigation","onAppLauncherActive","_applySlider","onAppLauncherInactive","_destroySlider","_renderHTMLItems","timerInterval","clearInterval","lorySlider","classNameSlideContainer","classNameFrame","ease","rewindSpeed","slideSpeed","slidesToScroll","infinite","enableMouseEvents","setInterval","next","callback","firstChild","sliderFrame","forEach","cname","classList","add","slideContainer","_loadImages","itemsLength","pending","_appendItem","itemSlide","item","slide","local","log","image","append","Array","push","innerHeight","cssWidth","cssHeight","_minHeight"],"mappings":"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","file":"carouselLight.min.js","sourcesContent":["'use strict';\r\n\r\nif (typeof (buildfire) == \"undefined\") throw (\"please add buildfire.js first to use carousel components\");\r\n\r\nif (typeof (buildfire.components) == \"undefined\")\r\n    buildfire.components = {};\r\n\r\nif (typeof (buildfire.components.carousel) == \"undefined\")\r\n    buildfire.components.carousel = {};\r\n\r\n(function () {\r\n    var scripts = document.getElementsByTagName('script');\r\n    var carouselScriptSrc = null;\r\n\r\n    for (var i = 0; i < scripts.length; i++) {\r\n        if (scripts[i].src && (scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.js') || scripts[i].src.toLowerCase().indexOf('buildfire/components/carousellight/carousellight.min.js'))) {\r\n            carouselScriptSrc = scripts[i].src;\r\n        }\r\n    }\r\n\r\n    if (carouselScriptSrc) {\r\n        if (typeof lory == 'undefined') {\r\n            document.write('<script src=\"' + carouselScriptSrc + '/../../../../lory/lory.min.js\"></script>');\r\n        }\r\n\r\n        //Add Lory CSS\r\n        var style = document.getElementById(\"loryInjectedStyle\");\r\n        if (style) document.head.removeChild(style);\r\n\r\n        style = document.createElement('style');\r\n        style.id = \"loryInjectedStyle\";\r\n        style.innerHTML += \" .loryFrame {position: relative;font-size: 0; line-height: 0; overflow: hidden; white-space: nowrap;}\";\r\n        style.innerHTML += \" .loryFrame li { position: relative; display: inline-block; height: 100%;}\";\r\n        style.innerHTML += \" .lorySlides { display: inline-block;}\";\r\n        style.innerHTML += \" .loryPercentage .lorySlides { display: block; padding: 0px;}\";\r\n        style.innerHTML += \" .loryPercentage li {  width: 100%;}\";\r\n\r\n        if (style.innerHTML.length > 0)\r\n            document.head.appendChild(style);\r\n        //# Add Lory CSS\r\n    }\r\n    else {\r\n        throw (\"carousellight components not found\");\r\n    }\r\n})();\r\n\r\n// This is the class that will be used in the mobile\r\n//{selector:selector, items:items, layout:layout, speed:speed}\r\nbuildfire.components.carousel.view = function (options) {\r\n    if ( options.items && options.items.length > 0) {\r\n        /*\r\n         if more than one image add carousel else add image directly to the carousel container\r\n         */\r\n        if (options.items.length > 1) {\r\n            this.config = this.mergeSettings(options);\r\n            this._initDimensions(this.config.layout);\r\n            this.init();\r\n        } else {\r\n            //add image directly to carousel container without adding the carousel lib\r\n            options.selector.innerHTML = '';\r\n            //append image tag\r\n            var img = document.createElement('img');\r\n            img.setAttribute(\"src\", buildfire.imageLib.cropImage(options.items[0].iconUrl, {\r\n                size: 'full_width',\r\n                aspect: '16:9',\r\n                width: window.innerWidth,\r\n                height: Math.ceil(9 * (window.innerWidth) / 16)\r\n            }));\r\n            img.alt = \"Carousel Image\";\r\n            options.selector.appendChild(img);\r\n            img.addEventListener(\"click\", function () {\r\n                buildfire.actionItems.execute(options.items[0], function (err, result) {\r\n                    if (err) {\r\n                        console.warn('Error openning slider action: ', err);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        options.selector.style.display=\"\";\r\n    } else {\r\n        options.selector.style.display=\"none\";\r\n    }\r\n\r\n};\r\n\r\n// Carousel view methods\r\nbuildfire.components.carousel.view.prototype = {\r\n    mergeSettings: function (options) {\r\n        var settings = {\r\n            selector: '.js_percentage',\r\n            items: [],\r\n            layout: null,\r\n            speed: 200,\r\n            loop: true,\r\n            autoInterval: 5 * 1000\r\n        };\r\n        var userSttings = options;\r\n        for (var attrname in userSttings) {\r\n            settings[attrname] = userSttings[attrname];\r\n        }\r\n        return settings;\r\n    },\r\n    init: function () {\r\n        this.selector = typeof this.config.selector === 'string' ? document.querySelector(this.config.selector) : this.config.selector;\r\n\r\n        if (!this.selector) {\r\n            throw (\"selecter not found\");\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        function validateLauncherCarousel() {\r\n            buildfire.getContext(function (err, result) {\r\n                if (result && result.device && result.device.platform && result.device.platform.toLowerCase() == 'ios' && buildfire.getFrameType() == \"LAUNCHER_PLUGIN\") {\r\n                    buildfire.navigation.onAppLauncherActive(function () {\r\n                        self._applySlider();\r\n                    }, true);\r\n                    buildfire.navigation.onAppLauncherInactive(function () {\r\n                        self._destroySlider();\r\n                    }, true);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (this.config.items && this.config.items.length > 0) {\r\n            this._renderHTMLItems(function () {\r\n                self._applySlider();\r\n                validateLauncherCarousel();\r\n            });\r\n        } else {\r\n            self._applySlider();\r\n            validateLauncherCarousel();\r\n        }\r\n    },\r\n    _destroySlider: function () {\r\n        if (this.timerInterval) {\r\n            clearInterval(this.timerInterval);\r\n            this.timerInterval = null;\r\n        }\r\n    },\r\n    _applySlider: function () {\r\n        if (!this.lorySlider) {\r\n            this.lorySlider = lory(this.config.selector, {\r\n                classNameSlideContainer: this.config.classNameSlideContainer || \"js_slides\",\r\n                classNameFrame: this.config.classNameFrame || 'js_frame',\r\n                ease: 'ease',\r\n                rewindSpeed: 600,//ms\r\n                slideSpeed: this.config.speed,//ms\r\n                slidesToScroll: this.config.slidesToScroll || 1,\r\n                infinite: this.config.infinite || 1,\r\n                enableMouseEvents: true\r\n            });\r\n        }\r\n\r\n        if (this.config.loop && this.config.items && this.config.items.length > 1) {\r\n            var self = this;\r\n\r\n            if (this.timerInterval) {\r\n                clearInterval(this.timerInterval);\r\n                this.timerInterval = null;\r\n            }\r\n\r\n            this.timerInterval = setInterval(function () {\r\n                self.lorySlider.next();\r\n            }, this.config.autoInterval);\r\n        }\r\n    },\r\n    _renderHTMLItems: function (callback) {\r\n        var self = this;\r\n\r\n        while (this.selector.firstChild) {\r\n            this.selector.removeChild(this.selector.firstChild);\r\n        }\r\n\r\n        this.sliderFrame = document.createElement('div');\r\n        ['loryFrame', 'js_frame'].forEach(function (cname) {\r\n            self.sliderFrame.classList.add(cname);\r\n        });\r\n\r\n        this.slideContainer = document.createElement('ul');\r\n        ['lorySlides', 'js_slides'].forEach(function (cname) {\r\n            self.slideContainer.classList.add(cname);\r\n        });\r\n\r\n        this._loadImages(this.config.items, function () {\r\n            ['slider', 'js_percentage', 'loryPercentage'].forEach(function (cname) {\r\n                self.selector.classList.add(cname);\r\n            });\r\n\r\n            self.sliderFrame.appendChild(self.slideContainer);\r\n            self.selector.appendChild(self.sliderFrame);\r\n\r\n            callback();\r\n        });\r\n    },\r\n    _loadImages: function (items, callback) {\r\n        var self = this;\r\n\r\n        var itemsLength = items.length;\r\n        var pending = itemsLength;\r\n\r\n        if (itemsLength == 0) {\r\n            callback();\r\n        }\r\n\r\n        for (var i = 0; i < itemsLength; i++) {\r\n            this._appendItem(items[i], function (itemSlide) {\r\n                pending--;\r\n                self.slideContainer.appendChild(itemSlide);\r\n\r\n                if (pending == 0) {\r\n                    callback();\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _appendItem: function (item, callback) {\r\n        var slide = document.createElement(\"li\");\r\n        slide.classList.add('js_slide');\r\n\r\n        slide.addEventListener(\"click\", function () {\r\n            buildfire.actionItems.execute(item, function (err, result) {\r\n                if (err) {\r\n                    console.warn('Error openning slider action: ', err);\r\n                }\r\n            });\r\n        });\r\n\r\n        buildfire.imageLib.local.cropImage(item.iconUrl, {\r\n            aspect: this.aspect,\r\n            size: 'full_width',\r\n            width: this.width,\r\n            height: this.height\r\n        }, function (err, result) {\r\n            if (!err) {\r\n                var image = document.createElement(\"img\");\r\n                image.src = result;\r\n                slide.appendChild(image);\r\n            }\r\n            else\r\n                console.log('Error occurred while cropping image: ', err);\r\n\r\n            callback(slide);\r\n        });\r\n    },\r\n    // allows you to append a single item or an array of items\r\n    append: function (items) {\r\n        if (!items)\r\n            return;\r\n        else if (!(items instanceof Array) && typeof(items) == \"object\")\r\n            items = [items];\r\n\r\n        if (items && items instanceof Array && items.length) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                this.items.push(items[i]);\r\n            }\r\n\r\n            var self = this;\r\n            this._loadImages(items, function () {\r\n                self._applySlider();\r\n            });\r\n        }\r\n    },\r\n    _initDimensions: function (layout) {\r\n        this.width = window.innerWidth;\r\n        layout = layout || \"WideScreen\";\r\n        if (layout == \"WideScreen\") {\r\n            this.height = Math.ceil(9 * this.width / 16);\r\n            this.aspect = '16:9';\r\n        } else if (layout == \"Square\") {\r\n            this.height = this.width;\r\n            this.aspect = '1:1';\r\n        } else if (layout == \"Cinema\") {\r\n            this.height = Math.ceil(1 * this.width / 2.39);\r\n            this.aspect = '2.39:1';\r\n        } else if (layout == \"MobileScreen\") {\r\n            this.height = (window.innerHeight / this.width) * this.width;\r\n            this.width = this.width;\r\n            this.aspect = '9:16';\r\n        }\r\n\r\n        this.cssWidth = this.width + \"px\";\r\n        if (this.height > 380) {\r\n            this.cssHeight = '380px';\r\n        } else {\r\n            this.cssHeight = this.height + \"px\";\r\n        }\r\n\r\n        // Set Min height on carousel so doesn't push content down on load.\r\n        this._minHeight = '180px';\r\n        this._minHeight = this.cssHeight;\r\n    }\r\n};\r\n"]}