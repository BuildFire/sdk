const stringToByteArray$1=function(r){const n=[];let a=0;for(let t=0;t<r.length;t++){let e=r.charCodeAt(t);e<128?n[a++]=e:(e<2048?n[a++]=e>>6|192:(55296==(64512&e)&&t+1<r.length&&56320==(64512&r.charCodeAt(t+1))?(e=65536+((1023&e)<<10)+(1023&r.charCodeAt(++t)),n[a++]=e>>18|240,n[a++]=e>>12&63|128):n[a++]=e>>12|224,n[a++]=e>>6&63|128),n[a++]=63&e|128)}return n},byteArrayToString=function(e){const t=[];let r=0,n=0;for(;r<e.length;){var a,o,i,s=e[r++];s<128?t[n++]=String.fromCharCode(s):191<s&&s<224?(a=e[r++],t[n++]=String.fromCharCode((31&s)<<6|63&a)):239<s&&s<365?(a=((7&s)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t[n++]=String.fromCharCode(55296+(a>>10)),t[n++]=String.fromCharCode(56320+(1023&a))):(o=e[r++],i=e[r++],t[n++]=String.fromCharCode((15&s)<<12|(63&o)<<6|63&i))}return t.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();var a=e?this.byteToCharMapWebSafe_:this.byteToCharMap_;const o=[];for(let r=0;r<n.length;r+=3){var i=n[r],s=r+1<n.length,c=s?n[r+1]:0,l=r+2<n.length,h=l?n[r+2]:0;let e=(15&c)<<2|h>>6,t=63&h;l||(t=64,s||(e=64)),o.push(a[i>>2],a[(3&i)<<4|c>>4],a[e],a[t])}return o.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(stringToByteArray$1(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):byteArrayToString(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(t,e){this.init_();var r=e?this.charToByteMapWebSafe_:this.charToByteMap_;const n=[];for(let e=0;e<t.length;){var a=r[t.charAt(e++)],o=e<t.length?r[t.charAt(e)]:0,i=++e<t.length?r[t.charAt(e)]:64,s=++e<t.length?r[t.charAt(e)]:64;if(++e,null==a||null==o||null==i||null==s)throw Error();n.push(a<<2|o>>4),64!==i&&(n.push(o<<4&240|i>>2),64!==s&&n.push(i<<6&192|s))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},base64Encode=function(e){e=stringToByteArray$1(e);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(e){return base64Encode(e).replace(/\./g,"")},base64Decode=function(e){try{return base64.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function getGlobal(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{var e;if("undefined"!=typeof process&&void 0!==process.env)return e=process.env.__FIREBASE_DEFAULTS__,e?JSON.parse(e):void 0},getDefaultsFromCookie=()=>{if("undefined"!=typeof document){let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var t=e&&base64Decode(e[1]);return t&&JSON.parse(t)}},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: "+e)}},getDefaultAppConfig=()=>{var e;return null==(e=getDefaults())?void 0:e.config};class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(r){return(e,t)=>{e?this.reject(e):this.resolve(t),"function"==typeof r&&(this.promise.catch(()=>{}),1===r.length?r(e):r(e,t))}}}function isIndexedDBAvailable(){try{return"object"==typeof indexedDB}catch(e){return!1}}function validateIndexedDBOpenable(){return new Promise((t,r)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),e||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{e=!1},a.onerror=()=>{var e;r((null==(e=a.error)?void 0:e.message)||"")}}catch(e){r(e)}})}const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var t=t[0]||{},r=this.service+"/"+e,e=this.errors[e],e=e?replaceTemplate(e,t):"Error",e=this.serviceName+`: ${e} (${r}).`;return new FirebaseError(r,e,t)}}function replaceTemplate(e,n){return e.replace(PATTERN,(e,t)=>{var r=n[t];return null!=r?String(r):`<${t}?>`})}const PATTERN=/\{\$([^}]+)}/g;function deepEqual(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;var a=e[i],o=t[i];if(isObject(a)&&isObject(o)){if(!deepEqual(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function isObject(e){return null!==e&&"object"==typeof e}class Component{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const DEFAULT_ENTRY_NAME$1="[DEFAULT]";class Provider{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){e=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(e)){const r=new Deferred;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{var t=this.getOrInitializeService({instanceIdentifier:e});t&&r.resolve(t)}catch(e){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),t=null!=(t=null==t?void 0:t.optional)&&t;if(!this.isInitialized(e)&&!this.shouldAutoInitialize()){if(t)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:e})}catch(e){if(t)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch(e){}for(var[t,r]of this.instancesDeferred.entries()){t=this.normalizeInstanceIdentifier(t);try{var n=this.getOrInitializeService({instanceIdentifier:t});r.resolve(n)}catch(e){}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){var{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(this.name+`(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);var n,a,o=this.getOrInitializeService({instanceIdentifier:r,options:t});for([n,a]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(n)&&a.resolve(o);return o}onInit(e,t){t=this.normalizeInstanceIdentifier(t);const r=null!=(n=this.onInitCallbacks.get(t))?n:new Set;r.add(e),this.onInitCallbacks.set(t,r);var n=this.instances.get(t);return n&&e(n,t),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){var r=this.onInitCallbacks.get(t);if(r)for(const n of r)try{n(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(e){}return r||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return!this.component||this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function normalizeIdentifierForFactory(e){return e===DEFAULT_ENTRY_NAME$1?void 0:e}function isComponentEager(e){return"EAGER"===e.instantiationMode}class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with `+this.name);t.setComponent(e)}addOrOverwriteComponent(e){const t=this.getProvider(e.name);t.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);var t=new Provider(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const instances=[];var LogLevel;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(LogLevel=LogLevel||{});const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(e,t,...r)=>{if(!(t<e.logLevel)){var n=(new Date).toISOString(),a=ConsoleMethod[t];if(!a)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[a](`[${n}]  ${e.name}:`,...r)}};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}function setLogLevel$1(t){instances.forEach(e=>{e.setLogLevel(t)})}function setUserLogHandler(o,e){for(const t of instances){let a=null;e&&e.level&&(a=levelStringToEnum[e.level]),t.userLogHandler=null===o?null:(e,t,...r)=>{var n=r.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");t>=(null!==a&&void 0!==a?a:e.logLevel)&&o({level:LogLevel[t].toLowerCase(),message:n,args:r,type:e.name})}}}const instanceOfAny=(t,e)=>e.some(e=>t instanceof e);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes=idbProxyableTypes||[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]}function getCursorAdvanceMethods(){return cursorAdvanceMethods=cursorAdvanceMethods||[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(o){const e=new Promise((e,t)=>{const r=()=>{o.removeEventListener("success",n),o.removeEventListener("error",a)},n=()=>{e(wrap(o.result)),r()},a=()=>{t(o.error),r()};o.addEventListener("success",n),o.addEventListener("error",a)});return e.then(e=>{e instanceof IDBCursor&&cursorRequestMap.set(e,o)}).catch(()=>{}),reverseTransformCache.set(e,o),e}function cacheDonePromiseForTransaction(o){var e;transactionDoneMap.has(o)||(e=new Promise((e,t)=>{const r=()=>{o.removeEventListener("complete",n),o.removeEventListener("error",a),o.removeEventListener("abort",a)},n=()=>{e(),r()},a=()=>{t(o.error||new DOMException("AbortError","AbortError")),r()};o.addEventListener("complete",n),o.addEventListener("error",a),o.addEventListener("abort",a)}),transactionDoneMap.set(o,e))}let idbProxyTraps={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return transactionDoneMap.get(e);if("objectStoreNames"===t)return e.objectStoreNames||transactionStoreNamesMap.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return wrap(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function replaceTraps(e){idbProxyTraps=e(idbProxyTraps)}function wrapFunction(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?getCursorAdvanceMethods().includes(r)?function(...e){return r.apply(unwrap(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(r.apply(unwrap(this),e))}:function(e,...t){t=r.call(unwrap(this),e,...t);return transactionStoreNamesMap.set(t,e.sort?e.sort():[e]),wrap(t)}}function transformCachableValue(e){return"function"==typeof e?wrapFunction(e):(e instanceof IDBTransaction&&cacheDonePromiseForTransaction(e),instanceOfAny(e,getIdbProxyableTypes())?new Proxy(e,idbProxyTraps):e)}function wrap(e){if(e instanceof IDBRequest)return promisifyRequest(e);if(transformCache.has(e))return transformCache.get(e);var t=transformCachableValue(e);return t!==e&&(transformCache.set(e,t),reverseTransformCache.set(t,e)),t}const unwrap=e=>reverseTransformCache.get(e);function openDB(e,t,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const i=indexedDB.open(e,t),s=wrap(i);return n&&i.addEventListener("upgradeneeded",e=>{n(wrap(i.result),e.oldVersion,e.newVersion,wrap(i.transaction))}),r&&i.addEventListener("blocked",()=>r()),s.then(e=>{o&&e.addEventListener("close",()=>o()),a&&e.addEventListener("versionchange",()=>a())}).catch(()=>{}),s}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(cachedMethods.get(t))return cachedMethods.get(t);const n=t.replace(/FromIndex$/,""),a=t!==n,o=writeMethods.includes(n);return n in(a?IDBIndex:IDBObjectStore).prototype&&(o||readMethods.includes(n))?(e=async function(e,...t){e=this.transaction(e,o?"readwrite":"readonly");let r=e.store;return a&&(r=r.index(t.shift())),(await Promise.all([r[n](...t),o&&e.done]))[0]},cachedMethods.set(t,e),e):void 0}}replaceTraps(n=>({...n,get:(e,t,r)=>getMethod(e,t)||n.get(e,t,r),has:(e,t)=>!!getMethod(e,t)||n.has(e,t)}));class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){const e=this.container.getProviders();return e.map(e=>{return isVersionServiceProvider(e)?(e=e.getImmediate()).library+"/"+e.version:null}).filter(e=>e).join(" ")}}function isVersionServiceProvider(e){e=e.getComponent();return"VERSION"===(null==e?void 0:e.type)}const name$o="https://www.gstatic.com/firebasejs/9.16.0/firebase-app.js",version$1="0.9.1",logger=new Logger("https://www.gstatic.com/firebasejs/9.16.0/firebase-app.js"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8="@firebase/performance",name$7="@firebase/performance-compat",name$6="@firebase/remote-config",name$5="@firebase/remote-config-compat",name$4="@firebase/storage",name$3="@firebase/storage-compat",name$2="@firebase/firestore",name$1="@firebase/firestore-compat",name$p="firebase",version$2="9.16.0",DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8]:"fire-perf",[name$7]:"fire-perf-compat",[name$6]:"fire-rc",[name$5]:"fire-rc-compat",[name$4]:"fire-gcs",[name$3]:"fire-gcs-compat",[name$2]:"fire-fst",[name$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"},_apps=new Map,_components=new Map;function _addComponent(t,r){try{t.container.addComponent(r)}catch(e){logger.debug(`Component ${r.name} failed to register with FirebaseApp `+t.name,e)}}function _addOrOverwriteComponent(e,t){e.container.addOrOverwriteComponent(t)}function _registerComponent(e){var t=e.name;if(_components.has(t))return logger.debug(`There were multiple attempts to register component ${t}.`),!1;_components.set(t,e);for(const r of _apps.values())_addComponent(r,e);return!0}function _getProvider(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function _removeServiceInstance(e,t,r=DEFAULT_ENTRY_NAME){_getProvider(e,t).clearInstance(r)}function _clearComponents(){_components.clear()}const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);class FirebaseAppImpl{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}const SDK_VERSION=version$2;function initializeApp(e,t={}){let r=e;if("object"!=typeof t){const n=t;t={name:n}}e=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},t);const n=e.name;if("string"!=typeof n||!n)throw ERROR_FACTORY.create("bad-app-name",{appName:String(n)});if(!(r=r||getDefaultAppConfig()))throw ERROR_FACTORY.create("no-options");t=_apps.get(n);if(t){if(deepEqual(r,t.options)&&deepEqual(e,t.config))return t;throw ERROR_FACTORY.create("duplicate-app",{appName:n})}const a=new ComponentContainer(n);for(const o of _components.values())a.addComponent(o);t=new FirebaseAppImpl(r,e,a);return _apps.set(n,t),t}function getApp(e=DEFAULT_ENTRY_NAME){var t=_apps.get(e);if(!t&&e===DEFAULT_ENTRY_NAME)return initializeApp();if(t)return t;throw ERROR_FACTORY.create("no-app",{appName:e})}function getApps(){return Array.from(_apps.values())}async function deleteApp(e){var t=e.name;_apps.has(t)&&(_apps.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function registerVersion(e,t,r){let n=null!=(a=PLATFORM_LOG_STRING[e])?a:e;r&&(n+="-"+r);var a=n.match(/\s|\//),e=t.match(/\s|\//);if(a||e){const o=[`Unable to register library "${n}" with version "${t}":`];return a&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&e&&o.push("and"),e&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void logger.warn(o.join(" "))}_registerComponent(new Component(n+"-version",()=>({library:n,version:t}),"VERSION"))}function onLog(e,t){if(null!==e&&"function"!=typeof e)throw ERROR_FACTORY.create("invalid-log-argument");setUserLogHandler(e,t)}function setLogLevel(e){setLogLevel$1(e)}const DB_NAME="firebase-heartbeat-database",DB_VERSION=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise=dbPromise||openDB(DB_NAME,DB_VERSION,{upgrade:(e,t)=>{0===t&&e.createObjectStore(STORE_NAME)}}).catch(e=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:e.message})})}async function readHeartbeatsFromIndexedDB(t){try{const e=await getDbPromise();return e.transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(t))}catch(e){e instanceof FirebaseError?logger.warn(e.message):(t=ERROR_FACTORY.create("idb-get",{originalErrorMessage:null==e?void 0:e.message}),logger.warn(t.message))}}async function writeHeartbeatsToIndexedDB(e,t){try{const r=await getDbPromise(),n=r.transaction(STORE_NAME,"readwrite"),a=n.objectStore(STORE_NAME);return await a.put(t,computeKey(e)),n.done}catch(e){e instanceof FirebaseError?logger.warn(e.message):(t=ERROR_FACTORY.create("idb-set",{originalErrorMessage:null==e?void 0:e.message}),logger.warn(t.message))}}function computeKey(e){return e.name+"!"+e.options.appId}const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=2592e6;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;e=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(e),this._heartbeatsCachePromise=this._storage.read().then(e=>this._heartbeatsCache=e)}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate();var t=e.getPlatformInfoString();const r=getUTCDateString();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some(e=>e.date===r))return this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{e=new Date(e.date).valueOf();return Date.now()-e<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";var e=getUTCDateString(),{heartbeatsToSend:t,unsentEntries:r}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),t=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,0<r.length?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),t}}function getUTCDateString(){const e=new Date;return e.toISOString().substring(0,10)}function extractHeartbeatsForHeader(e,t=MAX_HEADER_BYTES){const r=[];let n=e.slice();for(const a of e){const o=r.find(e=>e.agent===a.agent);if(o){if(o.dates.push(a.date),countBytes(r)>t){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),countBytes(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!isIndexedDBAvailable()&&validateIndexedDBOpenable().then(()=>!0).catch(()=>!1)}async read(){return await this._canUseIndexedDBPromise&&await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}}async overwrite(e){var t,r;if(await this._canUseIndexedDBPromise)return r=await this.read(),writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}async add(e){var t,r;if(await this._canUseIndexedDBPromise)return r=await this.read(),writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}function countBytes(e){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}function registerCoreComponents(e){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$o,version$1,e),registerVersion(name$o,version$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var name="firebase",version="9.16.0";registerVersion(name,version,"cdn");export{FirebaseError,SDK_VERSION,DEFAULT_ENTRY_NAME as _DEFAULT_ENTRY_NAME,_addComponent,_addOrOverwriteComponent,_apps,_clearComponents,_components,_getProvider,_registerComponent,_removeServiceInstance,deleteApp,getApp,getApps,initializeApp,onLog,registerVersion,setLogLevel};